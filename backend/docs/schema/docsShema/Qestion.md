Чтобы проект был «неубиваемым», мы будем придерживаться философии **«Минимум ручного труда — Максимум автоматизации»**. Если систему нельзя сломать ленью или глупостью сотрудника, она выживет.

Вот полные ответы на все 150 вопросов (сведенные в логические блоки), которые станут фундаментом вашего ТЗ и бизнес-модели.

---

### Блок 1: Позиционирование и Клиентский сегмент (B2B)
1. **ЦА:** Малый общепит (кофе-поинты, шаурма, пекарни, столовые в БЦ). Те, кому важен быстрый оборот.
2. **Конкуренция:** Фрилансер сделает «сайт-визитку», который не видит остатки в iiko. Мы продаем **автоматизацию**, а не просто сайт.
3. **Главная боль:** Упущенная выручка в час пик (люди видят очередь и уходят).
4. **Модель:** **White Label на едином ядре**. У каждого свой бренд, но код один. Это дешево в поддержке.
5. **Домен:** По умолчанию — поддомен (vash-brand.foodapp.ru). Свой домен — за доп. плату.
6. **Продажи:** Партнерство с дилерами iiko (им выгодно продавать допы) + холодный обзвон по картам (2GIS/Yandex).
7. **Другие кассы:** В MVP — только iiko. Распыление на r_keeper убьет старт.
8. **Без iiko:** Можно (ручная админка), но это не приоритет.
9. **Цена:** Сравнение: «Яндекс берет 300к с оборота 1 млн, мы берем 5к». Выгода очевидна.
10. **Пробный период:** 14 дней.

### Блок 2: Регистрация и Онбординг Пользователя (Гостя)
11. **Вход:** По номеру телефона.
12. **Авторизация:** SMS (дорого) → поэтому используем **VK ID / Telegram Auth** как основные, SMS — как резерв.
13. **Данные:** Только имя. Дату рождения — опционально (для маркетинга).
14. **Юридика:** Галочка «Согласен с офертой» при регистрации — обязательна (152-ФЗ).
15. **Анонимность:** Меню видеть можно, корзину собрать можно, но для оплаты — регистрация.
16. **Без регистрации:** Нет. Нам нужен телефон для связи.
17. **Любимая точка:** Запоминаем последнюю, где был заказ.
18. **Геолокация:** Запрашиваем. Если разрешил — подсовываем ближайшую точку.
19. **Выбор точки:** Список + карта.
20. **Add to Home Screen:** Всплывающее окно-подсказка при втором посещении.

### Блок 3: Меню и Каталог (Интеграция с iiko)
21. **Синхронизация:** Каждые 5 минут (остатки) и раз в сутки (картинки/описания).
22. **Иерархия:** Полное повторение дерева категорий из iiko.
23. **Stop-list:** Если товар в стопе в iiko — кнопка «В корзину» заменяется на «Нет в наличии».
24. **Конфликт в корзине:** Проверка стоп-листа еще раз в момент нажатия «Оплатить». Если товар кончился — ошибка и просьба удалить.
25. **Модификаторы:** Поддержка всех типов (обязательные, групповые, допы).
26. **Групповые модификаторы:** Да (например, выбор размера кофе).
27. **Комбо:** В MVP — нет (сложная логика в iiko).
28. **Теги:** Только если они заведены в iiko как свойства.
29. **Фото:** Тянем из iikoCloud. Если там нет — заглушка с логотипом.
30. **КБЖУ:** Тянем из iiko (если заполнены).
31. **Скрытие товаров:** В админке чекбокс «Не показывать в приложении» для категорий (например, «Хозтовары»).
32. **Весовой товар:** Цена за 100г, в корзине — выбор кратности.
33. **Поиск:** Обязателен по названию.
34. **Сортировка:** По порядку, заданному в iiko.
35. **Upsell:** Блок «С этим также берут» (настраивается в нашей админке).

### Блок 4: Оформление заказа (Бизнес-логика)
36. **Шаг времени:** 15 минут.
37. **«Как можно скорее»:** По умолчанию выбрано.
38. **Предзаказ:** Доступен только в рамках текущего или следующего дня.
39. **Мин. сумма:** Настраивается владельцем в админке.
40. **Комментарий:** Поле в корзине.
41. **Приборы:** Чекбокс «Нужны приборы».
42. **Вне рабочих часов:** Кнопка «Заказать» неактивна, текст «Откроемся в 09:00».
43. **Время готовности:** Фиксированное (настраивается владельцем, например, 20 мин).
44. **Повтор заказа:** В профиле кнопка «Повторить».
45. **Оплата:** Только онлайн в приложении. Никаких «на кассе» (чтобы избежать фейковых заказов).
46. **Не пришел:** Деньги не возвращаются (услуга оказана, еда приготовлена).
47. **Промокоды:** Свои (в нашей админке).
48. **Синхронизация скидок:** В iiko заказ падает уже со скидкой как «внешний бонус».
49. **iikoCard:** В MVP — нет.
50. **Лояльность:** Своя простая система (например, каждый 10-й кофе) — в будущем.

### Блок 5: Оплата (Эквайринг)
51. **Провайдер:** Т-Банк (Тинкофф) или ЮKassa.
52. **Комиссия:** Платит владелец (у него свой договор с банком).
53. **Фискализация:** Чек бьет iiko при получении заказа (облачный чек).
54. **СБП:** Обязательно (низкая комиссия 0.4-0.7%).
55. **Pay-сервисы:** Tinkoff Pay / SberPay.
56. **Привязка карты:** Да (рекуррентные платежи).
57. **Возврат:** Кнопка «Возврат» в нашей админке (через API банка).
58. **Списание:** Мгновенное.
59. **Чаевые:** В MVP — нет.
60. **Сбой интернета:** Если API iiko недоступно — оплата не предлагается, висит ошибка «Точка временно не принимает заказы».

### Блок 6: Статусы заказа и Уведомления
61. **Статусы:** Принят → Готовится → Готов → Выдан.
62. **Уведомления:** Push (через браузер) + Telegram-бот уведомление.
63. **Авто-статус:** Статус «Готов» подтягивается из iiko, когда повар отмечает готовность.
64. **Экран выдачи:** Крупный номер заказа и статус «Готов — можно забирать».
65. **QR выдачи:** Да, для быстрой идентификации сотрудником.
66. **Просрочка:** Через 2 часа статус меняется на «Завершен».
67. **Оценка:** Пуш через час после заказа.
68. **Отзывы:** Внутренние (видит только владелец).
69. **Ответ на отзыв:** Через админку.
70. **Уведомление персоналу:** Звуковой сигнал в терминале iiko + Telegram бот для сотрудников.

### Блок 7: Профиль пользователя
71. **История:** 20 последних заказов.
72. **Редактирование:** Имя и телефон (с подтверждением).
73. **Бонусы:** Отображение баланса (если внедрено).
74. **Помощь:** Кнопка связи с точкой (телефон).
75. **Удаление:** Обязательная кнопка «Удалить аккаунт» (требование регуляторов).
76. **Карты:** Список привязанных масок карт.
77. **Избранное:** Нет в MVP (лишнее усложнение).
78. **Рассылки:** Чекбокс в профиле.
79. **Язык:** Только русский.
80. **Выход:** Кнопка «Выйти».

### Блок 8: Админка для Владельца
81. **Статистика:** Выручка, средний чек, количество новых клиентов.
82. **Стоп-кнопка:** «Запара» — отключает прием заказов одним кликом.
83. **График:** Ручное переопределение часов работы.
84. **Цвета:** Выбор темы (3 варианта).
85. **Контент:** Загрузка лого и баннеров.
86. **Акции:** Конструктор простых баннеров на главную.
87. **Меню:** Управление видимостью категорий.
88. **Клиенты:** База с фильтром по количеству заказов.
89. **Пуши:** Рассылка по своей базе клиентов (за доп. плату).
90. **Налоги:** Настройка НДС (для чеков).
91. **Роли:** Владелец, Управляющий, Кассир.
92. **Оплата сервиса:** Раздел «Подписка» с картой.
93. **Блокировка:** Автоматическая при неуплате.
94. **Карта:** Установка метки на Yandex/Google картах.
95. **QR-коды:** Кнопка «Сгенерировать QR для стола».

### Блок 9: Интеграция с iiko (Техническая часть)
96. **API:** iikoTransport.
97. **Версия:** iikoCloud.
98. **Лицензии:** Клиент сам оплачивает iikoCloud (тариф с API).
99. **Товары:** UUID.
100. **Несколько терминалов:** Поддержка через выбор нужного TerminalID в админке.
101. **Ошибки:** Логирование в Sentry.
102. **Логи:** Хранение 14 дней.
103. **Создание гостя:** Автоматически при каждом новом телефоне.
104. **Маркетинг:** Поле `orderSource` = "OurAppName".
105. **Стоп-листы:** Опрос каждые 60 секунд.

### Блок 10: Интерфейс и UX
106. **Главная:** Баннеры → Категории → Популярное.
107. **Темы:** Только светлая (стандарт).
108. **Mobile-first:** Да.
109. **Иконки:** Стандартный пак.
110. **Кнопки:** Фиксированные тексты.
111. **Анимация:** Мягкий переход при добавлении в корзину.
112. **Скелетоны:** Обязательно вместо спиннеров.
113. **Алерты:** Красивые модальные окна.
114. **Назад:** Внутренняя навигация.
115. **Таббар:** Меню, Поиск, Заказы, Профиль.

### Блок 11: Маркетинг и Рост
116. **Рефералка:** Нет в MVP.
117. **Бонус за установку:** Можно реализовать через промокод «WELCOME».
118. **Лояльность:** Внешняя (iiko).
119. **Push:** Автоматические (статусы) и ручные (маркетинг).
120. **Гео-пуши:** Нет.
121. **Кросс-маркетинг:** Нет.
122. **Аналитика:** Яндекс.Метрика.
123. **VK Pixel:** По запросу.
124. **Лендинги:** Нет.
125. **Шаринг:** Ссылка на блюдо.

### Блок 12: Финансы и Юридические вопросы
126. **Договор:** Лицензионная оферта.
127. **Настройка:** 10к (разово).
128. **Счета:** Авто-инвойсинг.
129. **Франшизы:** Разные аккаунты.
130. **Сбои:** SLA 99.0%.
131. **Возвраты:** Только при техническом сбое системы.
132. **Данные:** Принадлежат владельцу точки, мы — оператор.
133. **Безопасность:** SSL, хеширование паролей.
134. **Сервера:** РФ (Selectel).
135. **Бэкапы:** Ежедневно.

### Блок 13: Технические детали
136. **Фронт:** Next.js.
137. **Бэк:** Node.js / NestJS.
138. **БД:** PostgreSQL + Redis для кэша.
139. **PWA:** Service Workers для кэширования статики.
140. **Оффлайн:** Просмотр меню без возможности заказа.
141. **Скорость:** LCP < 1.2 сек.
142. **Поддержка:** Тикет-система в Telegram.
143. **Баг-репорты:** Автоматически через Sentry.
144. **Мониторинг:** Grafana.
145. **Нагрузка:** Горизонтальное масштабирование через Docker.

### Блок 14: Крайние случаи (Edge Cases)
146. **Закрытие точки:** Если заказ принят, но точка закрылась — ручной возврат через админку.
147. **Алкоголь:** Проверка возраста сотрудником при выдаче (дисклеймер в приложении).
148. **Изменение заказа:** Невозможно. Только отмена → Возврат → Новый заказ.
149. **Цена изменилась:** Обновление корзины перед оплатой.
150. **Старый телефон:** Базовая HTML-версия (без части анимаций).

---
### Итог: Почему это сработает?
Эта логика исключает человеческий фактор:
- **Кассир не может забыть про заказ** (он падает прямо в iiko).
- **Владелец не может «забыть» оплатить** (система выключится сама).
- **Клиент не может «обмануть»** (только предоплата).
- **Разработчик не может «сломать»** один бренд, не сломав все (единое ядро).

Это идеальный «конвейер» для захвата рынка автоматизации малого общепита.